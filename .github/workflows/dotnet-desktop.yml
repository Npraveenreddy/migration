name: Build Specific API

on:
  workflow_dispatch:
    inputs:
      apiFolder:
        description: 'API folder to build'
        required: true
        default: 'AHS.GC.Web'
        type: choice
        options:
          - AHS.GC.Web
          - AHS.GC.authorizationportal
          - AHS.GC.ConfigAPI
          - AHS.GC.SmartComm
          - AHS.GC.Cloud

jobs:
  build:
    runs-on: windows-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Setup .NET
        uses: actions/setup-dotnet@v4
        with:
          dotnet-version: '6.0.x'

      - name: Build selected API
        shell: pwsh
        run: |
          $folder = "${{ github.event.inputs.apiFolder }}"
          Write-Host "=== Building API: $folder ==="

          $proj = Get-ChildItem -Path $folder -Filter "*.csproj" -Recurse -ErrorAction SilentlyContinue | Select-Object -First 1
          if ($proj) {
            dotnet restore $proj.FullName
            dotnet build $proj.FullName --configuration Release --no-restore
          }
          else {
            Write-Error "‚ùå No .csproj found in $folder"
            exit 1
          }
